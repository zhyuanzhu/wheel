# 加载策略

## 懒加载

> 也叫延迟加载，指的是长网页中延迟加载特定元素（可以是图片，也可以是 JS/CSS 文件，当然也可以是 js 的特定函数和和方法）（触发一定条件之后加载）

- 好处：减少当前屏无效资源的加载

- 实际方法和示例

  - 例如将图片的 `src` 初始化的时候不设置，给自定义属性 data-src 为图片的真实地址，触发加载条件之后使用 js 动态赋值加载

## 预加载

> 可以使用预加载让浏览器来预先加载某些资源（比如图片，JS/CSS/模版），而这些资源是在将来才会用到的。简单来说，就是将所需资源提前加载到浏览器本地，这样后面在需要使用的时候就可以直接在缓存中获取，不需要重新加载

- 好处：减少用户后续加载资源的等待时间

- 实现方式

  - HTML 标签，例如 img 等，先加载，但属性设置为 display: none

  - 使用 Image 对象， const img = new Image()  img.src = 'xx'

  - 使用 preload, prefetch 和 preconnect
  ```html
    <link rel="preload" href="src/style.css" as="style" >
    <link rel="prefetch" href="src/img.png" >
    <link rel="dns-prefetch" href="http://a.com" >
    <link rel="preconnect" href="http://a.com" crossorigin >

  ```
    - preload：提高某些资源等加载优先级，使得页面尽快渲染出来

    - prefetch：加载未来会用到的资源，下载优先级最低

    - preconnect：提早建立和第三方源的连接

    - dns-prefetch：解析将来会用到的资源的 DNS

## 预渲染

- 好处

  - 还未需要展示，已经提前渲染好

  - 懒加载组件被加载之前，组件可能还会有其他懒加载组件或数据，所以用户还需要时间等待组件加载完成

- 实现方式

  - prerender：<link rel="prerender" href="http://www.com">

## 按需加载

  - 不同设置按需加载（如 PC 端和移动端）

  - 不同 App 按需加载（如 js-sdk 脚本文件）

  - 不同分辨率按需加载（CSS Media Query）

  - Vue（`componentA = resolve => require('src', resolve)`） 和 React（`React.lazy`） 的按需载入

## 楼层式渲染

> 楼层数据异步加载和本地缓存相结合的方式

- 实现方式

  - 把页面按一定切割，缓存数据到本地，下次到该层的时候缓存中取数据；本地缓存数据的更新策略